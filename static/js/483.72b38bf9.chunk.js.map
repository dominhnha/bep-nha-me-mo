{"version":3,"file":"static/js/483.72b38bf9.chunk.js","mappings":"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","sources":["components/Animation/Sea/Sea.jsx","components/Button/Button/Button.jsx","components/FieldCustom/CustomSelect.jsx","pages/Payment/Payment.jsx","services/Authencation/PurchaseHistory.jsx","services/Authencation/User.jsx","utils/Format.js"],"sourcesContent":["import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport \"./Sea.scss\"\r\nconst Sea = props => {\r\n  return (\r\n    <div class=\"sea\">\r\n        <div class=\"circle-wrapper\">\r\n            <div class=\"bubble\"></div>\r\n            <div class=\"submarine-wrapper\">\r\n                <div class=\"submarine-body\">\r\n                    <div class=\"window\"></div>\r\n                    <div class=\"engine\"></div>\r\n                    <div class=\"light\"></div>\r\n                </div>\r\n                <div class=\"helix\"></div>\r\n                <div class=\"hat\">\r\n                <div class=\"leds-wrapper\">\r\n                    <div class=\"periscope\"></div>\r\n                    <div class=\"leds\"></div>\r\n                </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n  )\r\n}\r\n\r\nSea.propTypes = {}\r\n\r\nexport default Sea","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport \"./Button.scss\"\r\nconst Button = props => {\r\n  return (\r\n    <button class=\"Button\" \r\n        onClick={props.onClick ? (e) => props.onClick(e) : null}\r\n    >\r\n        {props.children}\r\n    </button>\r\n  )\r\n}\r\n\r\nButton.propTypes = {}\r\n\r\nexport default Button","import React from 'react';\r\nimport Select from 'react-select';\r\n\r\n\r\nexport default ({ onChange, options, value, className,placeholder }) => {\r\n\r\n    const defaultValue = (options, value) => {\r\n        return options ? options.find(option => option.value === value) : \"\";\r\n    };\r\n\r\n    return (\r\n        <div className={className}>\r\n            <Select\r\n                value={defaultValue(options, value)}\r\n                placeholder={placeholder}\r\n                onChange={value => {\r\n                    onChange(value)\r\n\r\n                }} options={options} />\r\n        </div>\r\n\r\n    )\r\n}","import React, { useContext } from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport { useFormik } from 'formik';\r\nimport * as Yup from \"yup\"\r\nimport './Payment.scss'\r\nimport Section, { SectionBody, SectionTitle } from '../../components/Section/Section';\r\nimport CustomSelect from '../../components/FieldCustom/CustomSelect';\r\nimport { PaymentContext } from '../../contexts/PaymentContextProvider';\r\nimport { v4 } from 'uuid';\r\nimport Sea from '../../components/Animation/Sea/Sea'\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport {formatNumber } from '../../utils/Format'\r\nimport Button from '../../components/Button/Button/Button';\r\nimport { useState } from 'react';\r\nimport { useEffect } from 'react';\r\nimport { useCallback } from 'react';\r\nimport { toast } from 'react-toastify';\r\nimport  { AuthContext } from '../../contexts/AuthContextProvider';\r\nimport { AddPurchaseHistoryForUser } from '../../services/Authencation/User';\r\nimport { CartContext } from '../../contexts/CartContextProvider';\r\nimport { CART__REMOVE } from '../../reducers/type';\r\nimport { CheckDiscount } from '../../services/Authencation/Discount';\r\n \r\nconst options = [\r\n  { value: 'advance', label: 'Thanh toán trước khi nhận hàng' },\r\n  { value: 'later', label: 'Thanh toán sau khi nhận hàng' },\r\n]\r\nconst Payment = props => {\r\n  const { Payment,Paymentdispatch} = useContext(PaymentContext);\r\n  const {Cart,Cartdispatch} = useContext(CartContext);\r\n  const {Authur,dispatch} = useContext(AuthContext);\r\n  const [Total,setTotal] = useState(0);\r\n  const history = useNavigate();\r\n  \r\n  \r\n  useEffect(()=>{\r\n    if(Payment.success == true && Payment.payload.length > 0){\r\n      let tmp = 0;\r\n      Payment.payload.map(item=>{\r\n        const curTotal = Number(item.Price) * Number(item.Quantity);\r\n        tmp+=curTotal;\r\n      })\r\n      setTotal(tmp);\r\n    }\r\n  },[Payment])\r\n\r\n  console.log(\"\",Authur)\r\n  console.log(\"ssssssssssssss\",Payment)\r\n  const formik = useFormik({\r\n    enableReinitialize: true,\r\n    initialValues: {\r\n      emailOrPhoneNumber: Authur.success == true ?Authur.payload.user.Number:\"\",\r\n      address:Authur.success == true ?Authur.payload.user.Address:\"\",\r\n      delivery:\"\",\r\n      voucher:\"\",\r\n\r\n    },\r\n    validationSchema: Yup.object({\r\n      emailOrPhoneNumber: Yup.string()\r\n        .max(254, \"Email hoặc số điện thoại bạn nhập phải ít hơn 254 kí tự\")\r\n        .required(\"Email / Số điện thoại không được bỏ trống\")\r\n        ,\r\n      address: Yup.string().required(\"Địa chỉ không được bỏ trống\"),\r\n      delivery:Yup.string().required(\"Phương thức thanh toán không được bỏ trống\")\r\n    }),\r\n\r\n    onSubmit: useCallback(\r\n      async(values) => {\r\n        try{\r\n          console.log(values.emailOrPhoneNumber,values.address, values.delivery)\r\n            let total = 0;\r\n            const initCart = Payment.payload.map(item=>{\r\n            const tmp = Number(item.Price) * Number(item.Quantity) \r\n              total+=tmp\r\n              const initItem =  {\r\n                pid:item.Pid,\r\n                quantity:Number(item.Quantity)\r\n              }\r\n              return initItem  \r\n          })\r\n          let discount = 0;\r\n          if(values.voucher.trim() != \"\"){\r\n             discount =await CheckDiscount(values.voucher.trim())\r\n             if(discount == 0){\r\n              toast.error('Mã giảm giá không hợp lệ', {\r\n                position: \"top-right\",\r\n                autoClose: 5000,\r\n                hideProgressBar: false,\r\n                closeOnClick: true,\r\n                pauseOnHover: true,\r\n                draggable: true,\r\n                progress: undefined,\r\n                theme: \"light\",\r\n                });\r\n              return;\r\n             }\r\n          } \r\n          total=total*(1-discount);\r\n          // user login\r\n          if(Authur.success == true && Payment.success == true){\r\n            \r\n            console.log(\"s\",Authur.payload.uid,{\r\n              emailOrPhone:values.emailOrPhoneNumber  ,\r\n              Address:values.address,\r\n              Total:total,\r\n              PriceDiscount:discount,\r\n              FullName:Authur.payload.user.FullName,\r\n              Payments:values.delivery\r\n\r\n            },initCart)\r\n            await AddPurchaseHistoryForUser(Authur.payload.uid,true,{\r\n              emailOrPhone:values.emailOrPhoneNumber  ,\r\n              Address:values.address,\r\n              Total:total,\r\n              PriceDiscount:discount,\r\n              FullName:Authur.payload.user.FullName,\r\n              Payments:values.delivery\r\n\r\n            },initCart)\r\n            \r\n          }else{\r\n            // authr false code here \r\n            const user = v4()\r\n            await AddPurchaseHistoryForUser(user,false,{\r\n              emailOrPhone:values.emailOrPhoneNumber  ,\r\n              Address:values.address,\r\n              Total:total,\r\n              PriceDiscount:discount,\r\n              FullName:user,\r\n              Payments:values.delivery\r\n\r\n            },initCart)\r\n\r\n          }\r\n          // remove item in cart \r\n          Payment.payload.map(item=>{\r\n            Cartdispatch({\r\n              type:CART__REMOVE,\r\n              payload:item.Pid,\r\n            })\r\n          })\r\n          toast.success('🦄 Mua hàng thành công!', {\r\n            position: \"top-right\",\r\n            autoClose: 5000,\r\n            hideProgressBar: false,\r\n            closeOnClick: true,\r\n            pauseOnHover: true,\r\n            draggable: true,\r\n            progress: undefined,\r\n            theme: \"light\",\r\n            });\r\n          history(\"/\");\r\n          // code here\r\n         \r\n          console.log(Payment.payload)\r\n        }catch(e){\r\n          console.log(e)\r\n          toast.error('Đã xảy ra lỗi vui lòng thử lại', {\r\n            position: \"top-right\",\r\n            autoClose: 5000,\r\n            hideProgressBar: false,\r\n            closeOnClick: true,\r\n            pauseOnHover: true,\r\n            draggable: true,\r\n            progress: undefined,\r\n            theme: \"light\",\r\n            });\r\n           \r\n            \r\n        }\r\n       // AddPurchaseHistoryForUser\r\n      },[Payment]\r\n    ) \r\n  });\r\n\r\n  return (\r\n    <div className='Payment'>\r\n      <div className=\"container Payment__container\">\r\n          <div className=\"Payment__infomation\">\r\n            <Section>\r\n              <SectionTitle>Thông tin khách hàng</SectionTitle>\r\n            <form action=\"\">\r\n              <div className=\"Payment__group input-container border--active\">\r\n                <input \r\n                  id = \"emailOrPhoneNumber\"\r\n                  name = \"emailOrPhoneNumber\"\r\n                  type=\"text\"\r\n                  // placeholder = \"Email / Số điện thoại\"\r\n                  onChange = {formik.handleChange}\r\n                  onBlur = {formik.handleBlur}\r\n                  value={formik.values.emailOrPhoneNumber}\r\n                  required\r\n                />\r\n                <label>Số điện thoại</label>\r\n                {formik.touched.emailOrPhoneNumber && formik.errors.emailOrPhoneNumber ?  <p className=\"error-message\">{formik.errors.emailOrPhoneNumber}</p> : null}\r\n              </div>\r\n              <div className=\" Payment__group input-container border--active\">\r\n                <input \r\n                  id = \"address\"\r\n                  name = \"address\"\r\n                  type=\"text\"\r\n                  // placeholder = \"Email / Số điện thoại\"\r\n                  onChange = {formik.handleChange}\r\n                  onBlur = {formik.handleBlur}\r\n                  value={formik.values.address}\r\n                  required\r\n                />\r\n                <label>Địa Chỉ</label>\r\n                {formik.touched.address && formik.errors.address ?  <p className=\"error-message\">{formik.errors.address}</p> : null}\r\n              </div>\r\n              <div className=\"Payment__group input-container\">\r\n                <CustomSelect\r\n                  className='input'\r\n                  onChange={value=>formik.setFieldValue('delivery',value.value)}\r\n                  value={formik.values.delivery}\r\n                  options={options}\r\n                  placeholder={\"Hình thức thánh toán\"}\r\n                  \r\n                  />\r\n                  {formik.touched.delivery && formik.errors.delivery ?  <p className=\"error-message active__error__xl\">{formik.errors.delivery}</p> : null}\r\n              </div>\r\n              {/* <button type=\"submit\" onClick={formik.handleSubmit}>Đăng Nhập</button> */}\r\n            </form>\r\n            </Section>\r\n            <Section>\r\n              <SectionTitle>Mã giảm giá </SectionTitle>\r\n              <div className=\"Payment__group input-container border--active\">\r\n                <input \r\n                  id = \"voucher\"\r\n                  name = \"voucher\"\r\n                  type=\"text\"\r\n                  // placeholder = \"Email / Số điện thoại\"\r\n                  onChange = {formik.handleChange}\r\n                  onBlur = {formik.handleBlur}\r\n                  value={formik.values.voucher}\r\n                  required\r\n                />\r\n                <label>Nhập mã giảm giá để được ưu đãi nhé </label>\r\n               \r\n              </div>\r\n            </Section>\r\n          </div>\r\n          <div className=\"Payment__Product\">\r\n              <Section>\r\n                <SectionTitle> Hóa đơn sản phẩm</SectionTitle>\r\n                <SectionBody>\r\n                  {\r\n                    Payment.success == true && Payment.payload.length > 0 \r\n                    ?<div className=\"Payment__Product__list\">\r\n                      \r\n                          {\r\n                            Payment.payload.map(item=>{\r\n                              const total = formatNumber(Number(item.Price) * Number(item.Quantity)) \r\n                              return(\r\n                                <div className=\"Payment__Product__item\">\r\n                                    <div className=\"Payment__Product__wrapper\">\r\n                                      <div className=\"Payment__Product__img\">\r\n                                        <img src={item.Image[0]} alt=\"\" />\r\n                                      </div>\r\n                                      <div className=\"Payment__Product__content\">\r\n                                        {/* <p>{item.Pid}</p> */}\r\n                                        <h2>{item.NameProduct}</h2>\r\n                                        <p>Số lượng: {item.Quantity}</p>\r\n                                      </div>\r\n                                    </div>\r\n                                    \r\n                                    <div className=\"Payment__Product__price\">\r\n                                      \r\n                                        <p>{formatNumber(total)}₫</p>\r\n                                    </div>\r\n                                </div>\r\n                              )\r\n                            })\r\n                          }\r\n                          \r\n                       \r\n                    </div>\r\n                    :<div className='Payment__Product__404'>\r\n                      <Sea></Sea>\r\n                      <h2 >Rất tiếc bạn chưa chọn sản phẩm để thanh toán </h2>\r\n                      <Link to={\"/Account/Cart\"}>Cùng quay lại giỏ hàng nhé !</Link>\r\n                    </div>\r\n                  }\r\n                  \r\n                </SectionBody>\r\n                <SectionTitle>\r\n                    <div className=\"Payment__total\">\r\n                      <div className=\"Payment__total__warpper\">\r\n                        <h2>Tổng tiền</h2>\r\n                        <span>{formatNumber(Total)}₫</span>\r\n                      </div>\r\n                        \r\n                        <div className=\"Payment__total__button\" onClick={formik.handleSubmit}>\r\n                          <Button>Mua Ngay</Button>\r\n                        </div>\r\n                    </div>\r\n                </SectionTitle>\r\n              </Section>\r\n          </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nPayment.propTypes = {}\r\n\r\nexport default Payment","import {db} from '../../Firebase__config'\r\nimport { addDoc, collection, doc, getDoc, getDocs, setDoc, updateDoc} from \"firebase/firestore\";\r\n\r\n\r\nconst CollectionName = \"PurchaseHistory\"\r\n\r\nexport const AddPurchaseHistory = async(uid,uPid,PurchaseHistory)=>{\r\n    const colRef = collection(db, CollectionName);\r\n    const PurDoc = await setDoc(doc(db,\"PurchaseHistory\",uPid),PurchaseHistory);\r\n    \r\n    await updateDoc(doc(db,\"PurchaseHistory\",uPid),{\r\n        Uid:uid,\r\n    })\r\n    \r\n    \r\n}\r\n\r\n//get PurchaseHistory by user\r\nexport const GetPurchaseHistoryByUser = async(uid)=>{\r\n    const colRef = collection(db, CollectionName);\r\n    const ListPur = [];\r\n    const ListPurUser = [];\r\n    const docsSnap = await getDocs(colRef)\r\n    docsSnap.forEach(doc=>{\r\n        ListPur.push({\r\n            PurID: doc.id,\r\n            Info:doc.data()\r\n        })\r\n    })\r\n    for(let i=0; i<ListPur.length; i++){\r\n        if(ListPur[i].Info.Uid ===uid){\r\n            ListPurUser.push(ListPur[i])\r\n        }\r\n    }\r\n    return{\r\n        success: true,\r\n        payload:ListPurUser,\r\n    }\r\n}","import {db} from '../../Firebase__config'\r\nimport { addDoc, arrayUnion, collection, deleteDoc, doc, getDoc, getDocs, query, serverTimestamp, setDoc, Timestamp, updateDoc } from \"firebase/firestore\";\r\nimport { async } from '@firebase/util';\r\nimport { set } from 'firebase/database';\r\nimport {AddBestSell, GetNameProduct, GetPriceProduct, GetQuantityProduct,} from '../Product/Product'\r\nimport { GetPercentDiscountByID } from './Discount';\r\nimport { AddPurchaseHistory } from './PurchaseHistory';\r\nconst CollectionName = \"User\"\r\n\r\n\r\nexport const AddUserCollection = async(uid,newUser)=>{\r\n    const {Email,firstname,lastname} = newUser;\r\n    const initUser = {\r\n        Email:Email,\r\n        Address:\"\",\r\n        Number:\"\",\r\n        ImgUser:\"https://mir-s3-cdn-cf.behance.net/project_modules/max_1200/36015793570193.5e6c1151cb04b.png\",\r\n        FullName:`${firstname} ${lastname}`,\r\n        Birthdate:\"\",\r\n        Role:\"user\",\r\n    }    \r\n    return await setDoc(doc(db, CollectionName, uid), initUser)\r\n    .then(e=>{\r\n        return {\r\n            success: true,\r\n            payload:null,\r\n        }\r\n    })\r\n    .catch((error) => {\r\n        return {\r\n            success: false,\r\n            payload:error,\r\n        }\r\n    })\r\n\r\n}\r\n\r\nexport const GetUserCollection = async(uid)=>{\r\n    \r\n    const docRef = doc(db, CollectionName, uid);   \r\n    const docSnap = await getDoc(docRef);\r\n    if (docSnap.exists()) {\r\n        return {\r\n            success: true,\r\n            payload:docSnap.data(),\r\n        }\r\n    } else {\r\n        // doc.data() will be undefined in this case\r\n        return {\r\n            success: false,\r\n            payload:\"No such document!\",\r\n        }\r\n    }\r\n}\r\n\r\nexport const UpdateUser = async(uid,updateUser)=>{\r\n    const {\r\n        Email,\r\n        Address,\r\n        Number,\r\n        ImgUser,\r\n        FullName,\r\n        Birthdate, \r\n        \r\n    } = updateUser;\r\n    console.log(Email)\r\n    const docRef = doc(db, CollectionName,uid);\r\n    return await updateDoc(docRef,{\r\n        Email:Email,\r\n        Address:Address,\r\n        Number:Number,\r\n        ImgUser:ImgUser,\r\n        FullName:FullName,\r\n        Birthdate:Timestamp.fromDate(new Date(Birthdate)) ,\r\n        Role: \"User\"\r\n    })\r\n    .then(docRef =>{\r\n        return{\r\n            success: true,\r\n            payload:updateUser\r\n        }\r\n    })\r\n    .catch(e=>{\r\n        return{\r\n            success: false,\r\n            payload:e\r\n        }\r\n    })\r\n\r\n\r\n}\r\n\r\nexport const AddToCart = async(value)=>{\r\n    const {uid,Pid,Number} = value;\r\n    const washingtonRef = doc(db,CollectionName, uid);\r\n    //const docRef = await doc(db, `${CollectionName}/${uid}/Cart/`);\r\n\r\n    // add new user \r\n    await updateDoc(washingtonRef, {\r\n        Cart: arrayUnion({\r\n            Pid:Pid,\r\n            Number:Number,\r\n        })\r\n    });\r\n \r\n}\r\nexport const GetToCart = async(uid)=>{\r\n    // const docRef = doc(db,CollectionName,`${uid}/Cart/`);\r\n    const washingtonRef = doc(db,CollectionName, uid,\"Cart\");\r\n    await getDoc(washingtonRef)\r\n    .then((e)=>{\r\n        return {\r\n            success: true,\r\n            payload:e,\r\n        }\r\n    })\r\n    .catch(e=>{\r\n        return {\r\n            success: false,\r\n            payload:e,\r\n        }\r\n    })\r\n    \r\n}\r\nexport const setNewCart = async(uid,listProduct)=>{\r\n    \r\n    const washingtonRef = doc(db,CollectionName, uid);\r\n    \r\n    // add new user \r\n    await updateDoc(washingtonRef, {\r\n        Cart: listProduct\r\n    })\r\n    .then(()=>{\r\n        return {\r\n            success: true,\r\n            payload:null,\r\n        }\r\n    })\r\n    .catch(e=>{\r\n        return {\r\n            success: false,\r\n            payload:e,\r\n        }\r\n    })\r\n}\r\n\r\n//PurchaseHistory\r\nexport const AddPurchaseHistoryForUser = async(uid,status,Cart,ListProduct=[{pid:\"\",quantity:\"\"}]) =>{ \r\n    const {emailOrPhone,Address,Payments,Total,PriceDiscount,\r\n        FullName\r\n    } = Cart;\r\n        const initPur = {\r\n            Item:ListProduct,\r\n            Discount:PriceDiscount,\r\n            Total:Total,\r\n            DayPurchased:serverTimestamp(),\r\n            Address:Address,\r\n            Payments:Payments,\r\n            FullName:FullName,\r\n            Email:emailOrPhone,\r\n            Status:\"Pending\",\r\n        }\r\n        if(status===true){\r\n            \r\n            const docRef = doc(db, CollectionName, uid);\r\n            const colRef = collection(docRef, \"PurchaseHistoryForUser\");\r\n            const PurDoc = await addDoc(colRef,initPur);\r\n            for(let i=0;i<ListProduct.length;i++){\r\n                const docRefP = doc(db,\"Product\",ListProduct[i].pid);\r\n                const QuantityProduct = await GetQuantityProduct(ListProduct[i].pid);\r\n                await updateDoc(docRefP,{\r\n                    Quantity:(QuantityProduct-ListProduct[i].quantity).toString()})\r\n                await AddBestSell(ListProduct[i].pid,ListProduct[i].quantity);\r\n                \r\n            }\r\n            await AddPurchaseHistory(uid,PurDoc.id,initPur);\r\n        }\r\n        else{\r\n            const colRef = collection(db,\"PurchaseHistory\");\r\n            const PurDoc = await addDoc(colRef,initPur);\r\n            const docPur = await doc(db,\"PurchaseHistory\",PurDoc.id);\r\n            for(let i=0;i<ListProduct.length;i++){\r\n                const docRefP = doc(db,\"Product\",ListProduct[i].pid);\r\n                const QuantityProduct = await GetQuantityProduct(ListProduct[i].pid);\r\n                await updateDoc(docRefP,{\r\n                    Quantity:(QuantityProduct-ListProduct[i].quantity).toString()\r\n                                     })\r\n                await AddBestSell(ListProduct[i].pid,ListProduct[i].quantity);\r\n                \r\n            }\r\n            await updateDoc(docPur,{\r\n                    Uid:uid,\r\n        })\r\n        }\r\n       \r\n    }\r\n    export const GetPurchaseHistoryByUser=async(uid,uPid)=>{\r\n        const docRef = doc(db, CollectionName,uid,\"PurchaseHistoryForUser\",uPid);\r\n        const docSnap = await getDoc(docRef);\r\n        if(docSnap.exists())\r\n            return await docSnap.data();\r\n        return{\r\n            success: false,\r\n            payload:\"No Purchase History\"\r\n        }\r\n    }\r\n    \r\n    //Get quantity product\r\n    export const GetQuantity=async(uid,uPid)=>{\r\n        const docRef = doc(db, CollectionName,uid,\"PurchaseHistoryForUser\",uPid);\r\n        const docSnap = await getDoc(docRef);\r\n        if(docSnap.exists())\r\n            return await docSnap.data().Item;\r\n        return{\r\n            success: false,\r\n            payload:\"No Purchase History\"\r\n        }\r\n    }","export  function formatNumber(num) {\r\n    return num.toString().replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, '$1,')\r\n}\r\n\r\nexport function formatTimestamptoDate(initdate){\r\n    let date = JSON.stringify(initdate)\r\n    return date.slice(1,11)\r\n}\r\n"],"names":["props","class","onClick","e","children","onChange","options","value","className","placeholder","find","option","defaultValue","label","useContext","PaymentContext","Payment","Paymentdispatch","CartContext","Cartdispatch","Cart","AuthContext","Authur","dispatch","useState","Total","setTotal","history","useNavigate","useEffect","success","payload","length","tmp","map","item","curTotal","Number","Price","Quantity","console","log","formik","useFormik","enableReinitialize","initialValues","emailOrPhoneNumber","user","address","Address","delivery","voucher","validationSchema","Yup","max","required","onSubmit","useCallback","values","total","initCart","pid","Pid","quantity","discount","trim","CheckDiscount","toast","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","undefined","theme","uid","emailOrPhone","PriceDiscount","FullName","Payments","AddPurchaseHistoryForUser","v4","type","CART__REMOVE","Section","action","id","name","handleChange","onBlur","handleBlur","touched","errors","CustomSelect","setFieldValue","formatNumber","src","Image","alt","NameProduct","Sea","to","handleSubmit","Button","CollectionName","AddPurchaseHistory","uPid","PurchaseHistory","collection","db","setDoc","doc","updateDoc","Uid","AddUserCollection","newUser","Email","firstname","lastname","initUser","ImgUser","Birthdate","Role","then","catch","error","GetUserCollection","docRef","getDoc","docSnap","exists","data","UpdateUser","updateUser","Timestamp","Date","status","ListProduct","initPur","Item","Discount","DayPurchased","serverTimestamp","Status","colRef","addDoc","PurDoc","i","docRefP","GetQuantityProduct","QuantityProduct","toString","AddBestSell","docPur","num","replace","formatTimestamptoDate","initdate","JSON","stringify","slice"],"sourceRoot":""}